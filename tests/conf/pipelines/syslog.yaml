# - name : input_file
#   watch_path : "/input/pihole"
#   path_pattern : "/input/pihole/jarvis*/syslog.*.log"
#   remove: True
#   tag : syslog

- name : dummy
  tag : syslog
  data :
   - {"log" : '{"source": "jarvis-2", "timestamp": 1606473683.8154814, "hostname": "OPNsense.localdomain", "date": "Nov 27 10:41:23", "log": "filterlog[45999]: 84,,,0,igb0,match,pass,out,4,0x0,,62,7993,0,DF,17,udp,94,192.168.1.1,208.67.222.222,62868,53,74"}'}

- name : parser_json
  key : log
  mode : merge
  match : syslog

- name : remove_keys
  keys : 
    - tag
  match : syslog

- name : stdout
  match : syslog

# - name : archive
#   time_key : timestamp
#   path_template : "/archives/pihole/{source}/syslog-%Y%m%d.json"
#   buffer_size : 1000
#   match : syslog

# - name : rethinkdb
#   time_key : timestamp
#   table_template : "jarvis-syslog-%Y%m%d"
#   buffer_size : 1000
#   database : test
#   ip : rethink
#   port : 28015
#   match : syslog
